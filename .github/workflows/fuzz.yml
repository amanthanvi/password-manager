name: Fuzz

on:
  workflow_dispatch:
  schedule:
    - cron: "0 5 * * 0"

jobs:
  fuzz:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout
        uses: actions/checkout@v5

      - name: Setup Rust (nightly)
        uses: dtolnay/rust-toolchain@nightly
        with:
          components: llvm-tools-preview

      - name: Install cargo-fuzz
        run: cargo install cargo-fuzz --locked

      - name: Fuzz (vault header parser)
        run: cargo fuzz run vault_header_parser -- -max_total_time=60

      - name: Fuzz (payload CBOR parser)
        run: cargo fuzz run payload_cbor_parser -- -max_total_time=60

      - name: Fuzz (CSV import parser)
        run: cargo fuzz run import_csv_parser -- -max_total_time=60

      - name: Fuzz (Bitwarden JSON import parser)
        run: cargo fuzz run import_bitwarden_json -- -max_total_time=60

